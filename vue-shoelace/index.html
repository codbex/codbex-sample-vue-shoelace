<!DOCTYPE html>

<head>

    <!-- Light & Dark Theme based on the userâ€™s prefers-color-scheme setting -->
    <link rel="stylesheet" media="(prefers-color-scheme:light)"
        href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/themes/light.css" />
    <link rel="stylesheet" media="(prefers-color-scheme:dark)"
        href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/themes/dark.css"
        onload="document.documentElement.classList.add('sl-theme-dark');" />

    <script type="importmap">
        {
        "imports": {
            "@shoelace-style/shoelace": "https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/shoelace.js"
        }
    }
    </script>

    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/shoelace-autoloader.js">
    </script>

    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.45/dist/vue.global.js"></script>
    <script type="module" src="./harmonia/index.js"></script>

    <style>
        :not(:defined) {
            visibility: hidden;
        }

    </style>
</head>

<body id="app">

    <ha-button size="small" ha-on-click="alertOnButtonClick">Click me</ha-button>
    <ha-input ha-on-change="alertOnInputChange" ha-value="inputValue"></ha-input>
    <ha-select label="Select a Few" multiple clearable ha-value="selectValue">
        <sl-option v-for="item in items" :value="item.value">{{item.name}}</sl-option>
    </ha-select>

    <ha-alert variant="primary" duration="5000" countdown="rtl" closable ha-value="myAlert">
        <sl-icon slot="icon" name="info-circle"></sl-icon>
        You're not stuck, the alert will close after a pretty long duration.
    </ha-alert>
    <ha-button variant="primary" closable ha-on-click="showAlert">Show Alert</ha-button>
    <ha-button variant="primary" closable ha-on-click="showToast">Show Toast</ha-button>
    <ha-button variant="primary" closable ha-on-click="showToastStack">Show Toast Stack</ha-button>

    <ha-alert ha-value="myToast" closable duration="3000">
        <sl-icon slot="icon" name="info-circle"></sl-icon>
        This is a toast #{{toastCounter}}
    </ha-alert>

    <script>
        const { createApp, reactive } = Vue;

        function showAlert() {
            $model.myAlert.show();
        }

        function showToast() {
            $model.toastCounter++;
            $model.myToast.toast();
        }

        function showToastStack() {
            $model.toastCounter++;
            notify(`This is a toast ${$model.toastCounter}`);
        }

        function alertOnButtonClick() {
            alert(`
                Button Click Event:
                    $model value is: ${$model.inputValue}
                    $model selectValue is: ${$model.selectValue}
            `);
        }

        function alertOnInputChange(event) {
            alert(`
                Input Change Event:
                    Event value is: ${event.target.value}
                    $model value is: ${$model.inputValue}
            `);
        }

        function notify(message, variant = 'primary', icon = 'info-circle', duration = 3000) {
            const alert = Object.assign(document.createElement('ha-alert'), {
            variant,
            closable: true,
            duration: duration,
            innerHTML: `
                <sl-icon name="${icon}" slot="icon"></sl-icon>
                <div>${message}</div>
            `
            });
            document.body.append(alert);
            return alert.toast();
        }


        createApp({
            setup() {
                window.$model = reactive({});
                $model.items = [
                        {
                        name: 'Banana',
                            value: 'banana'
                        },
                        {
                            name: 'Orange',
                            value: 'orange'
                        }
                    ];
                $model.inputValue = '1234';
                $model.selectValue = '';
                $model.toastCounter = 0;
                return $model;
        }}).mount('#app');

        setTimeout(() => {
            $model.inputValue = 'Vue + Shoelace data binding';
            $model.items.push({
                name: 'Test',
                value: 'test'
            });
            $model.selectValue = 'test';
        }, 2000);
    </script>
</body>

</html>
